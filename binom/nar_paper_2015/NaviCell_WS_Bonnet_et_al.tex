\documentclass[a4,center,fleqn]{NAR}

% Enter dates of publication
\copyrightyear{2008}
\pubdate{31 July 2009}
\pubyear{2009}
\jvolume{37}
\jissue{12}

%\articlesubtype{This is the article type (optional)}


\begin{document}

\title{NaviCell Web Service for Network-based Data Visualization}


\author{%
Eric Bonnet\,$^{1,2,3}$,
Eric Viara\,$^{4}$,
Inna Kuperstein\,$^{1,2,3}$,
Laurence Calzone\,$^{1,2,3}$,
David PA Cohen\,$^{1,2,3}$,
Emmanuel Barillot\,$^{1,2,3}$,
Andrei Zinovyev\,$^{1,2,3}$%
\footnote{To whom correspondence should be addressed.
Tel: +33 (0)1 56 24 69 89; Fax: +33 (0)1 56 24 69 11; Email: andrei.zinovyev@curie.fr}}

\address{%
$^{1}$Institut Curie, 26 rue d'Ulm, 75248 Paris, France, 
$^{2}$INSERM U900, 75248 Paris, France,
$^{3}$Mines ParisTech, 77300 Fontainebleau, France,
$^{4}$Sysra, 91330 Yerres, France.
}
% Affiliation must include:
% Department name, institution name, full road and district address,
% state, Zip or postal code, country

\history{%
Received January 1, 2009;
Revised February 1, 2009;
Accepted March 1, 2009}


\bibliographystyle{nar}
\maketitle

\begin{abstract}
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
\end{abstract}


\section{Introduction}

Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.

Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.

Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.

Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text.
Text 

\section{ALGORITHMS AND SOFTWARE}

\subsection{Implementation}

The NaviCell software tool is implementing a set of JavaScript functions on a
web interface, allowing an easy and intuitive navigation of large-scale
molecular maps of biological networks \cite{kuperstein2013navicell}. We
conceived the NaviCell Web Service Data Visualization tool as an extension of
NaviCell allowing users to visualize and analyze different types of "omics"
data. The Web Service is implemented at two different functional levels that are
interconnected. The first level corresponds to the interactive, windows-based,
usage of the web interface to load and visualize data. This level is implemented
as a specific set of JavaScript functions linked to a button-based menu located
in the right-hand panel of the web interface. The second level corresponds to a
programmatic usage of the service, which allow users to write programs that will
communicate with the NaviCell \emph{server} in order to automate all the
visualization operations. This functional level is implemented as a RESTful web
service, using standard web protocol HTTP operations and data encoding (JSON)
to perform all the necessary operations \cite{fielding2002principled}.
RESTful web service are very popular and have the advantage of being
lightweight, efficient and simple to use. In our case, they also have the benefit of
being relatively easy to implement in many different programming language and
software packages. At the moment we have a full API ready for Python, and
upcoming APIs for R and Java. Of course, those APIs will facilitate the
integration of NaviCell services in other applications, and for instance we
have started a collaboration to offer our data visualization services through
the Garuda Alliance web platform, which aims to be a one-stop service for
bioinformatics and systems biology \cite{ghosh2011software}. The Figure 1 is
summarizing the NaviCell \emph{server} architecture and information flow.

% **************************************************************
% Keep this command to avoid text of first page running into the
% first page footnotes
\enlargethispage{-65.1pt}
% **************************************************************


\subsection{Input data types}

We have designed the NaviCell data visualization service to be able to accept
several types of "omics" data. The complete list of data types that are
currently accepted for input is provided in table \ref{table:01}. The different
types are mapped to internal representations that determine what kind of
treatment will be done and what type of options will be possible to visualize
the data.

For instance, a mRNA expression data matrix will be associated to a
"continuous" internal representation. Thus, if the user is choosing to display
this data with a heatmap, a color gradient will be chosen by default, with the
appropriate options for modifying this representation. On the other hand, when a
matrix with discrete copy-number data is loaded, it is associated with a
"discrete unordered" internal representation, and this time a color palette will
be used for visualization, with a distinct color associated to each copy-number
value.

Users can also load annotation files to specify how samples can be grouped (e.g.
disease vs control, as a simple tab-delimited text file with sample names as rows and
grouping factors as columns). Then, an appropriate method will be used to summarize the
values of all the samples contained in a group, defined by the internal
representation. For instance, expression values will be averaged by default
("continuous" type), and the user will have the option to use the median, the
minimum value, the maximum value, etc. For mutation data ("discrete unordered"
type), taking the average does not make sense and instead the grouping method
will default to "at least one element of the group is mutated". 

%\begin{table}[b]
\begin{table}
\tableparts{%
\caption{List of current input data types for NaviCell data visualization. The
first column list the types as they appear in the NaviCell interface. The
second column list the internal representations that are used to determine what
type of data treatment will be applied for visualization.}
\label{table:01}%
}{%
\begin{tabular*}{\columnwidth}{@{}ll@{}}
\toprule
"Omics" data type &  Internal representation
%\\
%& (\%) & (s$^{-1}$) & (\%) & (s$^{-1}$)
\\
\colrule
mRNA expression data & continuous
\\
microRNA expression data & continuous
\\
Protein expression data & continuous
\\
Discrete copy number data & discrete ordered 
\\
Continuous copy number data & continuous
\\
Mutation data & discrete unordered 
\\
Gene list & set 
\\
\botrule
\end{tabular*}%
}
{The input format is standard tab-delimited text files, with samples as columns
and gene symbols (HUGO) as rows.}
\end{table}

\subsection{Graphical data representations}

Biology is a scientific discipline deeply grounded in visual representations,
that are important vectors to communicate results and ideas. 
[ interactive web visualizations are important and more and more used ]

We have included in the NaviCell web service for data visualization a number of
different graphical representations. Some of them are rather standard
and broadly used in biology (heatmaps, barplots), while others (glyphs, map
staining) have not been previously employed in the context of network-based
visualization as far as we know. 

\begin{itemize}

\item \textbf{Simple markers} are simle pictograms (similar to the ones found in Goggle Maps
to indicate geographical locations) that are draw on the map at the location
of a given species (protein, gene, complex). They are used to display the
results of a search done by the user or to display a list of genes of interest
uploaded on the map.

\item \textbf{Heatmaps} display individual values of a matrix as
colors. They are very often used in biology, especially to display expression
data measured from microarray experiments. In NaviCell, heatmaps can be used to
display continuous data types such as expression values, or discrete data such
as copy-number or mutation values. The user can arrange the display to have
several samples or group of samples displayed, and/or different experiments. 

\item \emph{Barplots} are chart with rectangular bars proportional to the values
they represent. On our web interface, they are also colored according to the
data value. Barplots can be very efficient to visually distinguish between two
or more groups of conditions (e.g. disease/control).  

\item \emph{Glyphs} are graphical representation using basic geometrical shapes
(triangle, square, rectangle, diamond, hexagon). The user can specify datasets
for the shape, the size and the color of the glyph. This type of representation
is particularly useful to visually combine different types of data. For
example, one might consider using matched data for copy-number and expression
on a set of samples. In this case, the shape of the glyphs could be assigned to
the copy-number values, while the expression data would be used for the color of
the glyph. Users can appreciate the two data types values at the same time on
the glyph.

\item \emph{Map staining} is a novel data representation where pre-defined areas
(or territories) around each entity are colored according to the data value. The
areas are defined on the map using Voronoi's diagrams. This geometrical
algorithm divides a surface into a finite set of convex polygons
\cite{aurenhammer1991voronoi}. In our case, we use all the entities present on a
molecular map as the seeds from which the polygons (or cells) are defined, and
that we will use to color the map, according to the data values attached to each
entity. The polygons are pre-calculated for each map, and colored dynamically on
the web interface according to the values of the data sets and the options
defined by the user.
\end{itemize}

\section{RESULTS}

\subsection{Results subsection one}

Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.
Text. Text. Text. Text. Text. Text. Text. Text. Text.

\section{DISCUSSION}

%\begin{table}[b]
\begin{table}
\tableparts{%
\caption{Comparison of the NaviCell Web Service for data visualization features with other tools.
}
\label{table:02}%
}{%
\begin{tabular*}{\columnwidth}{@{}lcccccc@{}}
\toprule
 Features & Na & Re & KE & iP & Bc & Pa
%\\
%& (\%) & (s$^{-1}$) & (\%) & (s$^{-1}$)
\\
\colrule
Map: navigation & $\bullet$ & $\bullet$ & & $\bullet$ & & $\bullet$ 
\\
Map: simple zooming & $\bullet$ & $\bullet$ & $\bullet$ & $\bullet$ & $\bullet$ &  $\bullet$ 
\\
Map: semantic zooming & $\bullet$ & $\bullet$ & & & &
\\
Visualization: node coloring & & $\bullet$ & & & & $\bullet$ 
\\
Visualization: heatmaps & $\bullet$ & & & & $\bullet$ &
\\
Visualization: barplots & $\bullet$ & & & & $\bullet$ &
\\
Visualization: glyphs & $\bullet$ & & & & &
\\
Visualization: map staining & $\bullet$ & & & & &
\\
Data mapping: gene lists& $\bullet$ & $\bullet$ & $\bullet$ & $\bullet$ & $\bullet$ & $\bullet$ 
\\
Data mapping: expression data& $\bullet$ & $\bullet$ & & & $\bullet$ & $\bullet$ 
\\
Data mapping: copy-number data& $\bullet$ & & & & &
\\
Data mapping: mutation data& $\bullet$ & & & & &
\\
Data mapping: metabolomic data& & $\bullet$ & & & &
\\
Data mapping: interactions & & $\bullet$ & & & &
\\
Programmatic access: RESTful web & $\bullet$ & $\bullet$ & $\bullet$ & & &
\\
Programmatic access: data visual. & $\bullet$ & & & & &
\\
\botrule
\end{tabular*}%
}
{Abbreviations: Na, NaviCell, Re, Reactome, KE, KEGG, iP, iPath, Bc, BioCyc, Pa, Patika.
}
\end{table}


\subsection{Discussion subsection one}

Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.

\subsection{Discussion subsection two}

Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.

\section{CONCLUSION}

Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.

\section{ACKNOWLEDGEMENTS}

Text. Text. Text. Text. Text. Text. Text. Text. Text. Text. Text.


\subsubsection{Conflict of interest statement.} None declared.
\newpage

\bibliography{biblio}

\section{TABLE AND FIGURE LEGENDS}

\textbf{Figure 1.} General architecture of the NaviCell Web service
\emph{server}. Client software (light blue layer) communicates with the server
(red layer) through standard HTTP requests using the standard JSON format to
encode data (RESTful web service, dark blue layer). A session (with a unique ID)
is established between the server and the client browser (yellow layer) through
Ajax communication channel to visualize the results of the commands send by the
client. It is worth noticing that communication channels are bidirectional, i.e.
the client software can send data (e.g. an expression data matrix) to the
server, but it can also receive data from the server (e.g. a list of gene HUGO
codes contained in a map).


\end{document}
